<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Support ‚Äî VibeNest</title>
  <link rel="stylesheet" href="/css/theme.css">
  <style>
    .support-grid { display: grid; grid-template-columns: 1fr 350px; gap: 24px; margin-top: 20px; }
    .support-form .form-group { margin-bottom: 16px; }
    .support-form label { display: block; margin-bottom: 6px; font-weight: 600; }
    .support-form input, .support-form textarea, .support-form select { width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--card); color: var(--text); font-family: inherit; }
    .support-form textarea { min-height: 140px; resize: vertical; }
    .sidebar { display: flex; flex-direction: column; gap: 16px; }
    .sidebar-section { background: var(--card); padding: 16px; border-radius: 8px; border: 1px solid var(--border); }
    .sidebar-section h3 { margin: 0 0 12px 0; color: var(--accent); font-size: 16px; }
    .sidebar-section ul, .sidebar-section dl { margin: 0; padding-left: 20px; }
    .sidebar-section dt { font-weight: 600; margin-top: 10px; }
    .sidebar-section dd { margin: 4px 0 8px 0; color: var(--muted); font-size: 0.9rem; }
    .sidebar-section li { margin-bottom: 6px; color: var(--muted); font-size: 0.9rem; }
    .flash-message { padding: 12px; border-radius: 8px; margin-bottom: 16px; }
    .flash-message.success { background: rgba(60,207,142,0.1); border: 1px solid rgba(60,207,142,0.3); color: var(--success); }
    .flash-message.error { background: rgba(255,107,107,0.1); border: 1px solid rgba(255,107,107,0.3); color: var(--danger); }
    @media (max-width: 900px) { .support-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <%- include('partials/header') %>
  
  <div class="container">
    <div style="margin-bottom: 24px;">
      <h1 style="margin: 0 0 8px 0;">Support & Help</h1>
      <p style="margin: 0; color: var(--muted);">Get help, report issues, or contact our team</p>
    </div>

    <% if (flash && flash.success) { %>
      <div class="flash-message success"><%= flash.success %></div>
    <% } %>
    <% if (flash && flash.error) { %>
      <div class="flash-message error"><%= flash.error %></div>
    <% } %>

    <div class="support-grid">
      <!-- LEFT: Form -->
      <div>
        <form id="supportForm" action="/support" method="POST" enctype="multipart/form-data" class="support-form">
          <div class="form-group">
            <label for="name">Name</label>
            <input id="name" name="name" type="text" placeholder="Your full name" value="<%= user ? (user.displayName || user.username) : '' %>" required>
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="your@email.com" value="<%= user ? user.email : '' %>" required>
          </div>

          <div class="form-group">
            <label for="category">Category</label>
            <select id="category" name="category" required>
              <option value="">Select a category...</option>
              <option value="general">General Question</option>
              <option value="bug">Bug Report</option>
              <option value="feature">Feature Request</option>
              <option value="account">Account Issue</option>
              <option value="privacy">Privacy / Data Request</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="subject">Subject</label>
            <input id="subject" name="subject" type="text" placeholder="Brief summary of your issue" required>
          </div>

          <div class="form-group">
            <label for="message">Message</label>
            <textarea id="message" name="message" placeholder="Describe your issue in detail. For bugs, include steps to reproduce." required></textarea>
          </div>

          <div class="form-group">
            <label for="attachment">Attachment (optional)</label>
            <input id="attachment" name="attachment" type="file" accept=".txt,.log,.png,.jpg,.jpeg,.pdf,.zip">
            <p style="font-size: 0.85rem; color: var(--muted); margin-top: 4px;">Max file size: 10MB. Do not include passwords or sensitive information.</p>
          </div>

          <button type="submit" class="btn btn-primary">Send Support Request</button>
          <p style="font-size: 0.85rem; color: var(--muted); margin-top: 12px;">We'll respond within 48 hours.</p>
        </form>
      </div>

      <!-- RIGHT: Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-section">
          <h3>üìñ Quick Links</h3>
          <ul style="list-style: none; padding: 0;">
            <li><a href="/" class="btn-link">‚Üê Back to Home</a></li>
            <li><a href="/settings" class="btn-link">Settings</a></li>
            <li><a href="/upload" class="btn-link">Upload Content</a></li>
          </ul>
        </div>

        <div class="sidebar-section">
          <h3>‚ùì FAQ</h3>
          <dl>
            <dt>How do I upload?</dt>
            <dd>Click "Upload" in the menu to share photos or videos to your feed.</dd>

            <dt>How do I like posts?</dt>
            <dd>Click the heart icon on any post to like it. Your likes are saved.</dd>

            <dt>I found a bug</dt>
            <dd>Select "Bug Report" above and describe what went wrong with steps to reproduce.</dd>

            <dt>Delete my data?</dt>
            <dd>Choose "Privacy / Data Request" to request account deletion or data export.</dd>
          </dl>
        </div>

        <div class="sidebar-section">
          <h3>‚ö° Troubleshooting</h3>
          <ul>
            <li>Clear browser cache (Ctrl+Shift+Del)</li>
            <li>Try incognito/private mode</li>
            <li>Use a different browser</li>
            <li>Check your internet connection</li>
          </ul>
        </div>
      </aside>
    </div>
  </div>

  <script>
    document.getElementById('supportForm').addEventListener('submit', function(e) {
      const message = document.getElementById('message').value.trim();
      if (!message) {
        e.preventDefault();
        alert('Please describe your issue in the message field.');
        document.getElementById('message').focus();
        return false;
      }
      const btn = this.querySelector('button[type="submit"]');
      btn.disabled = true;
      btn.textContent = 'Sending‚Ä¶';
    });
  </script>
  <script src="/js/theme-toggle.js"></script>
</body>
</html>
